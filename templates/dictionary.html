{% extends "base.html" %}
{% set active_page = 'dictionary' %}
{% block content %}

<!-- Page Heading -->
<section class="heading container center-align">
    <div>
        <h1>Our Wee Guide</h1>
    </div>
    <div class="description">
        <p>Click on the words below to find out what they mean</p>
    </div>

    <!-- Add Word Button -->
    {% if session.user %}
    <div>
        <a href="{{ url_for('add_word') }}" class="btn waves-effect waves-light z-depth-0">
            <i class="fas fa-plus"></i>
            Add Word
        </a>
    </div>
    {% endif %}

    <!-- Search Function -->
    <div class="row">
        <form action="{{ url_for('search') }}" method="post" class="col s12">
            <div class="input-field">
                <i class="fas fa-search prefix"></i>
                <input type="text" name="search" id="search">
                <label for="search">Search for a Word or a Phrase</label>
            </div>
            <div class="valign-wrapper">
                <!-- Search Button -->
                <button type="submit" class="btn search waves-effect waves-light z-depth-0">
                    <i class="fas fa-search"></i>
                    Search
                </button>
                <!-- Reset Button -->
                <a href="{{ url_for('dictionary') }}" class="btn reset waves-effect waves-light z-depth-0">
                    <i class="fas fa-undo"></i>
                    Reset
                </a>
            </div>
        </form>
    </div>
</section>

<!-- Dictionary -->
<section class="dictionary bg-img bg-img-dictionary">
    <div class="container">
        <ul class="collapsible popout center-align">
            {% for word in dictionary %}
            <li>
                <div class="collapsible-header">{{ word.word }}</div>
                <div class="collapsible-body">
                    <p><span class="italics">Definition: </span>{{ word.definition }}</p>
                    <p><span class="italics">Example: </span>"{{ word.example }}"</p>
                    <p><span class="italics">Added By: </span>{{ word.added_by }}</p>

                    <!-- Edit and Delete Buttons -->
                    <!-- Admin can delete and edit any of the words in the dictionary -->
                    {% if session.user == word.added_by or session.user == "admin" %}
                    <a href="{{ url_for('edit_word', word_id=word._id) }}"
                        class="btn edit waves-effect waves-light z-depth-0"><i class="fas fa-edit"></i> Edit</a>
                    <button data-target="{{ word._id }}"
                        class="btn delete modal-trigger waves-effect waves-light z-depth-0"><i
                            class="fas fa-trash-alt"></i> Delete</button>
                    {% endif %}
                </div>
            </li>

            <!-- Delete Confirmation Modal -->
            <!-- Code below is from a slack thread in #data-centric-dev that helped fix the issue the first word in the collection being deleted instead of the targeted word -->
            <div id="{{ word._id }}" class="modal">
                <div class="modal-content">
                    <h4>Are you sure you want to delete "{{ word.word }}"" from Our Wee Guide?</h4>
                </div>
                <div class="modal-footer center-align">
                    <a href="#!" class="btn delete modal-close waves-effect waves-light z-depth-0"><i
                            class="fas fa-times"></i> Cancel</a>
                    <a href="{{ url_for('delete_word', word_id=word._id) }}"
                        class="btn delete waves-effect waves-light z-depth-0"><i class="fas fa-trash-alt"></i>
                        Delete</a>
                </div>
            </div>

            {% endfor %}
        </ul>
    </div>

    <div class="img-description">
        <p><span>Belfast City Hall</span> - Belfast, Northern Ireland</p>
    </div>
</section>

{% endblock %}